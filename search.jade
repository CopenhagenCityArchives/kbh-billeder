extends index

append header
  if results.is_search || results.is_front || results.is_category || results.is_catalog
    +searchMeta(results, catalog, breadcrumbs)
    
block before-content
  if !results.is_front
    include filtering

block content
  section.container-fluid

    .search-page__header 

      h1
        if results.is_search
          | Søgning på "#{filters.freetext}"
          +searchCount
        if results.is_category
          a.breadcrumbs-link.dark(href='/#{catalog.alias}') #{catalog.name}
          if breadcrumbs
            if breadcrumbs.second
              | &nbsp; &gt; &nbsp;
              a.breadcrumbs-link(href='/#{catalog.alias}?cat=#{breadcrumbs.first.id}') #{breadcrumbs.first.name}
              | &nbsp; &gt; &nbsp;
              span #{breadcrumbs.second.name}
                +searchCount
            else if breadcrumbs.first
              | &nbsp; &gt; &nbsp;
              span #{breadcrumbs.first.name}
                +searchCount
          else
            | &nbsp; &gt; Ingen titel

        if results.is_catalog
          | #{catalog.name}
          +searchCount

      .search-page__sorting
        | Sorteret efter
        .dropdown
          a.dropdown__selected= sortOptions[filters.params.sorting].label
          .dropdown__options
            each val, key in sortOptions
              - var selected = (key === filters.params.sorting)
              - var url = noSortingUrl + '&sort=' + key
              a.dropdown__option(href=url, 
                class=selected ? 'dropdown__option--active' : '') #{val.label} 

    .search-results.row(id="masonry-container")
      each result in results.results
        +searchResultAsset(result)

  .clearfix
  
  #page-nav
    a(href='#{infinitepath}')

  if(results.total_results_raw > 10)
    button.btn.btn-primary.btn-lg.load-more(data-action="load-more")
      +loader('Vis flere...')

  include includes/footer

block after-footer
  if !results.is_front
    a#toTop
      +icon('scrolltotop')

append javascript
  script.
    $(function() {
      $('#toTop').scrollToTop(400);
      // To ensure no boxes are hidden if the was some load error
      $('.loaded-more').removeClass('loaded-more');
    });
  if results.is_front
    script.
      $(window).load(function() {
         $('.slider').flexslider({
          animation: "slide",
          controlNav: false,
          start: function(slider) {
            $(window).trigger('resize');
          }
        });
      });
