extends index

append header
  if result.isSearch || result.isCategory || result.isCatalog
    +searchMeta(result, catalog, breadcrumbs)
    
block content

  section.search-page__filtering
    .container-fluid
      each filter, filterKey in filterOptions
        - var currentChoice = filters.params.filters[filterKey] || false
        .dropdown
          a.dropdown__selected(
            class=currentChoice ? '' : 'dropdown__selected--not-bold') 
            if currentChoice
              = filter.options[currentChoice].label
            else 
              = filter.label
          .dropdown__options
            a.dropdown__option(href=helpers.urlQuery(fullPath, filterKey, undefined), 
              class=!currentChoice ? 'dropdown__option--active' : '') 
                | Filtrer ikke efter #{filter.label.toLowerCase()} 
            each option, key in filter.options
              - var selected = key === currentChoice
              - var url = helpers.urlQuery(fullPath, filterKey, key)
              a.dropdown__option(href=url, 
                class=selected ? 'dropdown__option--active' : '') #{option.label} 

  section.container-fluid
    .search-page__header.row 

      h1.col-xs-12.col-sm-7.col-md-8.col-lg-8
        if result.isSearch
          | Søgning på "#{filters.freetext}"
          +searchCount
        if result.isCategory
          a.breadcrumbs-link.dark(href='/#{catalog.alias}') #{catalog.name}
          if breadcrumbs
            if breadcrumbs.second
              | &nbsp; &gt; &nbsp;
              a.breadcrumbs-link(href='/#{catalog.alias}?cat=#{breadcrumbs.first.id}') #{breadcrumbs.first.name}
              | &nbsp; &gt; &nbsp;
              span #{breadcrumbs.second.name}
                +searchCount
            else if breadcrumbs.first
              | &nbsp; &gt; &nbsp;
              span #{breadcrumbs.first.name}
                +searchCount

        if result.isCatalog
          | #{catalog.name}
          +searchCount

      .search-page__sorting.col-xs-12.col-sm-5.col-md-4.col-lg-4
        | Sorteret efter
        .dropdown
          a.dropdown__selected= sortOptions[filters.params.sorting].label
          .dropdown__options
            each val, key in sortOptions
              - var selected = (key === filters.params.sorting)
              - var url = helpers.urlQuery(fullPath, 'sort', key)
              a.dropdown__option(href=url, 
                class=selected ? 'dropdown__option--active' : '') #{val.label} 

    .search-results.row(id="masonry-container")
      each asset in result.hits
        +searchResultAsset(asset)

  .clearfix
  
  #page-nav
    a(href='#{infinitepath}')

  if(result.totalCountRaw > 10)
    button.btn.btn-primary.btn-lg.load-more(data-action="load-more")
      +loader('Vis flere...')
      
  a#toTop
    +icon('scrolltotop')

  include includes/footer

append javascript
  script.
    $(function() {
      $('#toTop').scrollToTop(400);
      // To ensure no boxes are hidden if the was some load error
      $('.loaded-more').removeClass('loaded-more');
    });
